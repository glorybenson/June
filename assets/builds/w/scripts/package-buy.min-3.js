function confirmPost(e){return!!confirm(e)}function more_details(e){jQuery("#efMoreInfo_"+e).dialog({modal:!0,height:400,width:550})}function shuffle_tables(){1==jQuery("#efOptionalTable tr:visible").length?(jQuery("#efOptionalTable").hide(),jQuery("#efPackageOptionalItemsTitle").hide()):(jQuery("#efOptionalTable").show(),jQuery("#efPackageOptionalItemsTitle").show()),1==jQuery("#efOptionalIncludedTable tr").length?jQuery("#efOptionalIncludedTable").hide():jQuery("#efOptionalIncludedTable").show()}function redraw_classes(){jQuery(".efOptionalTrProduct").removeClass("efOdd"),jQuery(".efOptionalTrProduct").removeClass("efEven");var n=0;jQuery.each(jQuery(".efOptionalTrProduct"),function(e,t){var a=(n=jQuery(t).prev().hasClass("efTableSubheader")?0:n)%2==1?"efEven":"efOdd";jQuery(t).addClass(a),n++})}function enable_payment_loader(e){var t=jQuery("#efPaymentLoader"),a=jQuery("#efPaymentOptions");"1"==e?(a.hide(),t.show()):(a.show(),t.hide())}function termsAndConditionsCheck(){return jQuery("#tcagree").is(":checked")}function showTermsAndConditionsWarning(){jQuery('<div title="Error"><p><img src="/assets/icons/exclamation.png" alt="!" style="float:left;margin-right:4px;margin-top:2px" />You must agree to the terms and conditions.</p></div>').dialog({height:150,width:400,modal:!0,resizable:!1})}function add_product(e,t,a,n){var a=a||"Add",n=n||"Remove",r=parseInt(jQuery("#optional_quantity_"+e).val());isNaN(r)&&(r=1);var i="P"+e,o=1,l=taxesnotbetaxin[i],d=jQuery("#optional_"+e).data("subheader");1<r&&(o=multibuy_discount[i]);var u=r*prices[i]*l*o,u=currency_format(u);u=parseFloat(u);var s,c=r*prices[i]*o;s="1"==display_incvat?u:c;l=types[i],o="";o=(o=o+'<tr id="optional_included_'+e+'" class="efOptionalTrProduct" data-subheader='+d+" >\n")+"<td>"+names[i]+' <input type="hidden" id="optional_included_quantity_'+e+'" name="quantity['+i+']" value="'+r+'"></td>\n',o+="<td>","1"==hasDetails[i]&&(o=o+'<a href="javascript:more_details('+e+')">Details</a>'),o=(o=(o=(o+="</td>\n")+'<td align="center">'+r+"</td>\n")+'<td style="text-align:right">&pound;'+currency_format(s)+"</td>\n")+'<td style="text-align:right"><input type="button" class="efButton" value=\''+n+"' onclick=\"remove_product("+e+",'"+t+"', '"+a+"', '"+n+"')\" /></td>\n",o+="</tr>\n";n=0;0<fees[i]&&(n=r*fees[i],o=(o=o+'<tr id="optional_included_'+e+'_fee">\n')+"<td>"+feenames[i]+"</td>\n",o=(o=(o+="<td></td>\n")+'<td align="center">'+r+"</td>\n")+'<td style="text-align:right">&pound;'+currency_format(n)+"</td>\n",o+='<td style="text-align:right"></td>\n',o+="</tr>\n"),jQuery("#efOptionalIncludedTable").show(),jQuery("#efOptionalIncludedTable").append(o),jQuery(".efButton").button(),jQuery("#optional_"+e).remove(),packprice=packprice+u+n,packnetprice=packnetprice+c+n,"REGOFFICE"!=l&&"MAILFORWARD"!=l&&"MEMARTSDOC"!=l||jQuery(".optional_product_"+l).hide(),shuffle_tables(),jQuery("#efPackageTotal span").html("&pound;"+currency_format(packprice)),jQuery("#efPackageNet span").html("&pound;"+currency_format(packnetprice)),jQuery("#efPackageTax span").html("&pound;"+currency_format(parseFloat(packprice)-parseFloat(packnetprice))),redraw_classes()}function remove_product(e,t,a,n){var r="P"+e,i=parseInt(jQuery("#optional_included_quantity_"+e).val()),o=1,l=taxesnotbetaxin[r];1<i&&(o=multibuy_discount[r]);var d=prices[r]*l*i*o+fees[r]*i*1,u=prices[r]*i*o+fees[r]*i*1,s=fullprices[r]*l*i*o+fees[r]*i*1,c=prices[r]*l+fees[r],p=prices[r]+fees[r],o=types[r];i="1"==display_incvat?c:p;l='<input id="optional_quantity_'+e+'" type="hidden" value="1">\n',c=jQuery("#optional_included_"+e).data("subheader");"1"==multibuy[r]&&(l='<input id="optional_quantity_'+e+'" value="1" class="efQuantity">\n');p="";p=(p=p+'<tr id="optional_'+e+'" data-subheader='+c+' class="optional_product_'+o+' efOptionalTrProduct"">\n')+"<td>"+names[r]+"</td>\n",p+="<td>","1"==hasDetails[r]&&(p=p+'<a href="javascript:more_details('+e+')">Details</a>'),p+="</td>\n",p+='<td style="text-align:right">',d<s&&(p=p+"&pound;"+currency_format(s)),p+="</td>\n",p+='<td style="text-align:right">',0<savingamounts[r]&&(p=p+'<span class="efSavingAmount">&pound;'+currency_format(savingamounts[r])+'</span> <span class="efSavingPercentage">'+savingpercs[r]+"%</span>\n"),p=(p=(p+="</td>\n")+'<td style="text-align:right">&pound;'+currency_format(i)+"</td>\n")+'<td style="text-align:right">'+l+'</td><td align="right" style="text-align:right"><input type="button" class="efButton" value=\''+a+"' onclick=\"add_product("+e+",'"+t+"', '"+a+"', '"+n+"')\" /></td>\n",p+="</tr>\n",jQuery("#"+c).after(p),jQuery(".efButton").button(),jQuery("#optional_included_"+e).remove(),0<jQuery("#optional_included_"+e+"_fee").length&&jQuery("#optional_included_"+e+"_fee").remove(),packprice-=d,packnetprice-=u,"REGOFFICE"!=o&&"MAILFORWARD"!=o&&"MEMARTSDOC"!=o||jQuery(".optional_product_"+o).show(),shuffle_tables(),jQuery("#efPackageTotal span").html("&pound;"+currency_format(packprice)),jQuery("#efPackageNet span").html("&pound;"+currency_format(packnetprice)),jQuery("#efPackageTax span").html("&pound;"+currency_format(parseFloat(packprice)-parseFloat(packnetprice))),redraw_classes()}